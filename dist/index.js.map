{"version":3,"sources":["../index.js"],"names":["ScrollContainer","Component","ScrollMonitorContainer","state","container","el","findDOMNode","createContainer","props","offsets","setState","scrollContainer","children","Watch","isInViewport","initialRender","isAboveViewport","isBelowViewport","isFullyInViewport","watcher","create","updateState","on","listeners","eventTypes","forEach","type","autoStart","startWatcher","innerRef","watchItem","nextProps","stopWatcher","Object","assign","update","triggerCallbacks","off","lockWatcher","unlockWatcher","propTypes","bool","shape","defaultProps","lock","unlock","createWatcher","destroy","WatchedComponent"],"mappings":"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","file":"index.js","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types'\nimport hoistStatics from 'hoist-non-react-statics';\n\nimport scrollMonitor from 'scrollmonitor';\n\nexport const ScrollContainer = (Component) => {\n\tclass ScrollMonitorContainer extends React.Component {\n\t\tconstructor () {\n\t\t\tsuper();\n\n\t\t\tthis.state = {\n\t\t\t\tcontainer: null\n\t\t\t};\n\t\t}\n\n\t\tcomponentDidMount () {\n\t\t\tvar el = ReactDOM.findDOMNode(this);\n\t\t\tvar container = scrollMonitor.createContainer(el, this.props.offsets);\n\t\t\tthis.setState({\n\t\t\t\tscrollContainer: container\n\t\t\t});\n\t\t}\n\n\t\trender () {\n\t\t\treturn (<Component\n\t\t\t\tscrollContainer={this.state.scrollContainer}\n\t\t\t\t{...this.props}\n\t\t\t>\n\t\t\t\t{this.props.children}\n\t\t\t</Component>);\n\t\t}\n\t}\n\treturn hoistStatics(ScrollMonitorContainer, Component);\n};\n\nexport const Watch = (Component) => {\n\treturn class WatchedComponent extends React.Component {\n\t\tstatic propTypes = {\n\t\t\tautoStart: PropTypes.bool,\n\t\t\tinitialRender: PropTypes.shape({\n\t\t\t\tisInViewport: PropTypes.bool,\n\t\t\t\tisAboveViewport: PropTypes.bool,\n\t\t\t\tisBelowViewport: PropTypes.bool,\n\t\t\t\tisFullyInViewport: PropTypes.bool\n\t\t\t})\n\t\t};\n\n\t\tstatic defaultProps = {\n\t\t\tautoStart: true,\n\t\t\tinitialRender: {\n\t\t\t\tisInViewport: false,\n\t\t\t\tisAboveViewport: false,\n\t\t\t\tisBelowViewport: false,\n\t\t\t\tisFullyInViewport: false\n\t\t\t}\n\t\t};\n\n\t\tconstructor (props) {\n\t\t\tsuper(props);\n\t\t\tthis.state = {\n\t\t\t\tisInViewport: this.props.initialRender.isInViewport,\n\t\t\t\tisAboveViewport: this.props.initialRender.isAboveViewport,\n\t\t\t\tisBelowViewport: this.props.initialRender.isBelowViewport,\n\t\t\t\tisFullyInViewport: this.props.initialRender.isFullyInViewport\n\t\t\t};\n\t\t}\n\n\t\tcreateWatcher (props) {\n\t\t\tvar el = ReactDOM.findDOMNode(this);\n\t\t\tthis.watcher = (props.scrollContainer || scrollMonitor).create(el, props.offsets);\n\n\t\t\tconst updateState = () => {\n\t\t\t\tthis.setState({\n\t\t\t\t\tisInViewport: this.watcher.isInViewport,\n\t\t\t\t\tisAboveViewport: this.watcher.isAboveViewport,\n\t\t\t\t\tisBelowViewport: this.watcher.isBelowViewport,\n\t\t\t\t\tisFullyInViewport: this.watcher.isFullyInViewport\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tthis.watcher.on('stateChange', updateState);\n\n\t\t\tthis.listeners = {};\n\n\t\t\tscrollMonitor.eventTypes.forEach(type => {\n\t\t\t\tif (props[type]) {\n\t\t\t\t\tthis.listeners[type] = () => this.props[type](this.watcher, this.props);\n\t\t\t\t\tthis.watcher.on(type, this.listeners[type]);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tupdateState();\n\t\t}\n\n\t\tcomponentDidMount () {\n\t\t\tif (this.props.autoStart) {\n\t\t\t\tthis.startWatcher();\n\t\t\t}\n\n\t\t\tif (this.props.innerRef) {\n\t\t\t\tthis.props.innerRef(this.watcher.watchItem, this.watcher, this.props);\n\t\t\t}\n\t\t}\n\n\t\tUNSAFE_componentWillReceiveProps (nextProps) {\n\t\t\tif (this.props.scrollContainer !== nextProps.scrollContainer) {\n\t\t\t\tthis.stopWatcher();\n\t\t\t\tthis.startWatcher(nextProps);\n\t\t\t}\n\n\t\t\tif (this.props.offsets !== nextProps.offsets) {\n\t\t\t\tObject.assign(this.watcher.offsets, nextProps.offsets);\n\t\t\t\tthis.watcher.update();\n\t\t\t\tthis.watcher.triggerCallbacks();\n\t\t\t}\n\n\t\t\tscrollMonitor.eventTypes.forEach(type => {\n\t\t\t\tif (nextProps[type] && !this.props[type]) {\n\t\t\t\t\tthis.listeners[type] = () => this.props[type](this.watcher);\n\t\t\t\t\tthis.watcher.on(type, this.listeners[type]);\n\t\t\t\t} else if (!nextProps[type] && this.props[type]) {\n\t\t\t\t\tthis.watcher.off(type, this.listeners[type]);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tcomponentWillUnmount () {\n\t\t\tthis.stopWatcher();\n\t\t}\n\n\t\tlockWatcher = () => {\n\t\t\tif (this.watcher) {\n\t\t\t\tthis.watcher.lock();\n\t\t\t}\n\t\t};\n\n\t\tunlockWatcher = () => {\n\t\t\tif (this.watcher) {\n\t\t\t\tthis.watcher.unlock();\n\t\t\t}\n\t\t};\n\n\t\tstartWatcher = (props = this.props) => {\n\t\t\tif (!this.watcher) {\n\t\t\t\tthis.createWatcher(props);\n\t\t\t}\n\t\t};\n\n\t\tstopWatcher = () => {\n\t\t\tif (this.watcher) {\n\t\t\t\tthis.watcher.destroy();\n\t\t\t\tthis.watcher = null;\n\t\t\t}\n\t\t};\n\n\t\trender () {\n\t\t\treturn (<Component\n\t\t\t\tisInViewport={this.state.isInViewport}\n\t\t\t\tisAboveViewport={this.state.isAboveViewport}\n\t\t\t\tisBelowViewport={this.state.isBelowViewport}\n\t\t\t\tisFullyInViewport={this.state.isFullyInViewport}\n\t\t\t\tlockWatcher={this.lockWatcher}\n\t\t\t\tunlockWatcher={this.unlockWatcher}\n\t\t\t\tstartWatcher={this.startWatcher}\n\t\t\t\tstopWatcher={this.stopWatcher}\n\t\t\t\t{...this.props}\n\t\t\t>\n\t\t\t\t{this.props.children}\n\t\t\t</Component>);\n\t\t}\n\t}\n\treturn hoistStatics(WatchedComponent, Component);\n};\n"]}